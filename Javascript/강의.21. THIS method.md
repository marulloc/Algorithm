# This 관련 메소드 (call, apply, bind)

## this와 call()

### call 메소드 사용

- `call` 메소드는 `getTotal.call()`와 같이 함수.call 형태로 사용한다.
- `getTotal.call(this, 10, 20)`과 같이 파라미터를 넘길 수 있다.
  - 첫번째 인자는 파라미터로 넘어가지 않고, 두번째 인자 10부터 파라미터로 넘어가게 된다.
  - 첫번째 인자는 호출된 함수에서 **this로 참조할 오브젝트**를 명시한다. (모든 오브젝트가 가능하다.)
- 호출하면서 첫번째 인자를, 실행 컨텍스트의 **this바인딩 컴포넌트**로 바인딩하겠다는 목적으로 사용한다.

<br>

### 예시

```javascript
var value = 100;
function get(param) {
  console.log(this);
  return param + this.value;
}
var result = get.call(this, 20);
console.log(result);
```

- `get`함수의 console.log(this)는 window를 반환하게 된다.

  - **call 메소드의 인자로 this를 넘겼는데, 이때의 this는 Global Object인 window다.**
  - 따라서 window의 value 값인 100과 param으로 넘긴 20이 더해진 120이 반환된다.

    #### Object를 this로 참조하게 만들면 아래와 같다.

    ```javascript
    var obj = { value: 80 };

    var result = get.call(obj, 20);
    console.log(result); //=> 100
    ```

    - 위와 같이 call 메소드에 this로 참조할 오브젝트를 `obj`로 바꾸면, get함수는 obj를 this로 참조하게 된다. 따라서 100이 반환된다.

#### this로 참조할 오브젝트를 변경할 수 있는 것이 call의 특징이다.

<br>

### primitive 타입을 바인딩하는 call

```javascript
function get() {
  return this.valueOf();
}
var result = get.call(123);
console.log(result);
```

- this가 object를 참조해야하므로, 숫자를 작성하면 에러가 발생할 것 같지만, 그렇지 않다.

1. 값(123)의 타입에 해당하는 **Number 인스턴스를 생성**하고, 123을 primitive 값으로 설정한 후에 넘기게 된다.
2. 엔진은 this바인딩 컴포넌트에 **Number 객체의 인스턴스**를 바인딩한다.
3. 함수에서는 `this.valueOf`로 primitive 값을 꺼낼 수 있다.

<br>

### this 참조 변경

```javascript
var book = {
  value: 123,
  point: {
    value: 456,
    get() {
      console.log(this.value);
    },
  },
};
```

잠깐 정리하자, **this는 작성된 위치에 따라 결정되는 것이 아니라, 호출한 오브젝트가 누구냐에 따라 결정된다.** 저 코드만 봤을 때, this.value는 자동으로 456일 것 같지만, 우리가 get을 호출할 때, `book.point.get()`을 사용하고, this가 point 객체에 바인딩되기 때문에 this.value가 456임을 알아야 한다. 이 this는 call과 같은 함수에 의해 바뀔 수 있기 때문에, 저런 코드만 보고 this가 누굴 참조하는지 결정할 수 없다.

<br>

```javascript
var book = {
  value: 123,
  point: {
    value: 456,
    get() {
      console.log(this.value);
    },
  },
};
book.point.get.call(book); //=> 123
book.point.get.call(book.point); //=> 456
```

- `book.point.get.call(book) //=> 123`
  call 메소드의 첫번째 매개변수가 book이다. 따라서 이때, get 함수의 this는 **book 오브젝트**가 되고 value : 123을 가져오게 된다.

- `book.point.get.call(book.point); //=> 456`
  call 메소드의 첫번째 매개변수가 book.point이다. 따라서, 이때 get 함수의 this는 book안에 위치한 **point 오브젝트가 된다.**(book은 point 오브젝트의 경로를 알려주는 의미뿐이다.) value : 456을 가져오게 된다.

<br>
<br>

## 내 정리

#### bind와 call 함수 차이

```Javascript
function getPoint(param){
    console.log(param, this.point)
}

var obj1 = {point:10}
var obj2 = {point:100000}

getPoint.call(obj1, "첫번째")
getPoint.call(obj2, "두번째")
```

#### 전역의 this

```Javascript
point = 100
function get(){
    console.log(this.point)
}

var obj2 = {
    point : 7777,
    get(){
        console.log(this.point)
    }
}

get()       //=> 100
obj2.get()  //=> 7777
```
