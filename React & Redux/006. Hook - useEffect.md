# hook `useEffect()`

- 부수효과를 처리하기 위한 훅
- 부수효과란 외부의 상태를 변경하는 것을 의미한다. 서버 API를 호출하거나, 이벤트 핸들러를 등록하는 것이 부수효과다.
- 부수효과가 많은 프로젝트는, **순수 함수가 가지는 여러 장점을 포기하게 되는 등, 유닛테스트가 힘들어진다.**

```jsx
useEffect(() => {
  console.log("side effect");
}, [variable]);
```

- 첫 번째 매개변수로 함수를 입력한다. **이 함수는 컴포넌트가 렌더링 된 "후"에 호출된다.** 더 정확하게 하면, 렌더링 결과가 실제 돔에 반영되고 **비동기로 호출**된다. 이 함수를 **부수 효과 함수**라고 한다.
- 두 번째 매개변수로 배열을 입력한다. **이 배열은 의존성 배열이라고 부른다.** 리-렌더가 발생할 때 마다 부수효과 함수가 실행되는 것은 매우 비효율적이다.(부수효과함수가 하는 일은 API 호출과 같은 일이므로)
  - 이 배열의 요소가 변화될 때마다, 부수효과함수가 실행되도록 하는 것이다.
  - 만약 배열이 비어있으면, 컴포넌트가 생성될 때만 부수효과 함수가 호출된다.

<br>
<br>
<br>
<br>

### 부수효과함수의 반환

```jsx
useEffect(() => {
  console.log("side effect");
  return () => {
    console.log("called");
  };
}, [variable]);
```

- 부수효과가 반환하는 함수 `return () => {console.log("called") }`은 **다음 부수효과함수가 호출되기 "직전"에 호출되거나** 또는, 컴포넌트가 사라지기 직전, 즉, **컴포넌트가 unmount되기 직전에 마지막으로 호출된다.**

  - 따라서 **이벤트 핸들러 등록과 제거에 유용하다.**

  ```jsx
  useEffect(() => {
    const handler = () => {
      console.log("클릭 핸들러");
    };
    window.addEventListener("click", handler);

    return () => {
      window.removeEventListener("click", handler);
    };
  }, []);
  ```

  - 컴포넌트가 생성될 때, 이벤트 핸들러를 등록한다.
  - 컴포넌트가 사라질 때, 이벤트 핸들러를 제거한다
