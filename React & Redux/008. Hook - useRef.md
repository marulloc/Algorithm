# useRef

리액트로 작업하다보면, 실제 DOM 요소에 접근해야 하는 경우가 필요하다. 예를 들면, DOM 요소를 포커싱하거나 DOM 요소의 크기나 스크롤 위치를 알고 싶은 경우가 있다. 이때 useRef를 이용하면 자식 요소에 직접 접근할 수 있다.

- 자식요소는 DOM일 수도 있고, 리액트 컴포넌트일 수도 있다.

<br>
<hr>
<br>
<br>

## 기초 사용법

- ref 속성과 useRef 훅 사용

```jsx
import React, { useRef, useEffect } from "react";

export default function App() {
  const inputRef = useRef();
  useEffect(() => {
    inputRef.current.focus();
  }, []);

  return (
    <div>
      <input type="text" ref={inputRef} />
      <button> 저장 </button>
    </div>
  );
}
```

- `<input type="text" ref={inputRef} />` 에서 ref 속성값에 useRef가 반환해준 것을 넣어준다.
- `inputRef.current.focus();`에서 current는 실제 DOM 요소를 가리킬 수 있다.
  - 따라서 DOM의 focus 함수를 실행할 수 있다.
- **ref 속성은 DOM 요소 뿐만 아니라, 컴포넌트에도 적용할 수 있다.**

> **리액트의 렌더링 결과가 실제 돔에 반영된 후에 DOM 요소에 접근이 가능하다.**
> 따라서 DOM요소에 접근하는 코드가 useEffect 안에 위치하고 있다.

<br>
<hr>
<br>
<br>

## 컴포넌트에서 ref 사용

```jsx
import React, { useRef, useEffect } from "react";

export default function App() {
  const inputRef = useRef();
  useEffect(() => {
    inputRef.current.focus();
  }, []);

  return (
    <div>
      <InputAndSave inputRef={inputRef} />
      <Button ref={inputRef} />
    </div>
  );
}

function InputAndSave({ inputRef }) {
  return (
    <div>
      <input type="text" ref={inputRef} />
      <button>저장</button>
    </div>
  );
}

//forwardRef 함수 사용
const Button = React.forwardRef(function ({ onClick }, ref) {
  return (
    <button onClick={onClick} ref={ref}>
      저장
    </button>
  );
});
```

- 별다른 처리를 하지 않는다면, **컴포넌트에는 ref 속성 값을 사용할 수 없다.**
  - 컴포넌트에 ref를 입력하면, 리액트가 내부적으로 처리하기 때문이다.
  - 따라서 위의 코드에선 `inputRef`라는 props를 만들어 내려보내고 있다.
- `<Button ref={inputRef} />`와 같이 직관적으로 **ref 속성을 사용하기 위해 `forwardRef`라는 함수를 사용한다.**
  - forwardRef 함수를 사용하면, 두번째 매개변수로 _ref_ 속성값을 받을 수 있다.

> **InputAndSave** 컴포넌트에 넘겨주는 ref의 이름은 **inputRef**가 적절하다.
> 해당 컴포넌트 아래에는 많은 요소들이 있기 때문에, 어떤 참조 값인지 명시해주기 위해 ref 이름을 inputRef로 사용하는 것이 적절하다.

<br>
<hr>
<br>
<br>

## ref 속성 값에 함수를 입력

```jsx
import React, { useRef, useEffect } from "react";

export default function App() {
  const inputRef = useRef();
  useEffect(() => {
    inputRef.current.focus();
  }, []);

  return (
    <div>
      <InputAndSave inputRef={inputRef} />
      <Button ref={inputRef} />
    </div>
  );
}
```
